import{e as b,j as e,T as c,P as u,S as f,h as g,u as p,c as m,r as h,N as y,O as C,B as T,C as E}from"./index-CKLgkD1v.js";import{E as v}from"./Event-42ReEdWN.js";import{L as I}from"./LocationOn-qhTYfCyv.js";import{T as S,a as W,b as $,c as j,d as k}from"./TableRow-DM6qFwiW.js";import{T as n}from"./TableCell-BtnOls6d.js";import{C as o}from"./Chip-DfvBT8qY.js";import{A as z}from"./Alert-DDDj34Iz.js";const A=b(e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m3.3 14.71L11 12.41V7h2v4.59l3.71 3.71z"})),L=({exams:i})=>{if(!i||i.length===0)return e.jsx(c,{sx:{mt:3,textAlign:"center",color:"text.secondary"},children:"本学期暂无考试安排信息。"});const x=s=>{let t=s,r="default";switch(s){case"final":t="期末考试",r="primary";break;case"midterm":t="期中考试",r="secondary";break;case"makeup":t="补考",r="warning";break;default:t=s;break}return e.jsx(o,{label:t,size:"small",color:r,variant:"filled"})};return e.jsx(S,{component:u,elevation:3,sx:{mt:2},children:e.jsxs(W,{sx:{minWidth:700},"aria-label":"考试安排列表",children:[e.jsx($,{sx:{backgroundColor:"grey.100"},children:e.jsxs(j,{children:[e.jsx(n,{sx:{fontWeight:"bold"},children:"课程名称"}),e.jsx(n,{sx:{fontWeight:"bold"},children:"考试类型"}),e.jsx(n,{sx:{fontWeight:"bold"},children:"日期"}),e.jsx(n,{sx:{fontWeight:"bold"},children:"时间"}),e.jsx(n,{sx:{fontWeight:"bold"},children:"地点"}),e.jsx(n,{align:"right",sx:{fontWeight:"bold"},children:"时长 (分钟)"})]})}),e.jsx(k,{children:i.map(s=>{var t,r;return e.jsxs(j,{hover:!0,children:[e.jsx(n,{component:"th",scope:"row",children:e.jsx(o,{icon:e.jsx(f,{}),label:`${s.courseName} (${s.courseCode})`,variant:"outlined",size:"small"})}),e.jsx(n,{children:x(s.examType)}),e.jsx(n,{children:e.jsx(o,{icon:e.jsx(v,{}),label:g(s.examDate,"yyyy年MM月dd日"),size:"small"})}),e.jsx(n,{children:e.jsx(o,{icon:e.jsx(A,{}),label:`${(t=s.startTime)==null?void 0:t.substring(0,5)} - ${(r=s.endTime)==null?void 0:r.substring(0,5)}`,size:"small"})}),e.jsx(n,{children:e.jsx(o,{icon:e.jsx(I,{}),label:`${s.building} ${s.roomNumber}`,size:"small",variant:"outlined"})}),e.jsx(n,{align:"right",children:s.duration})]},s.examId)})})]})})},O=()=>{const i=p(),{myExams:x,isLoading:s,error:t,currentSemesterId:r,hasLoadedMyExams:l}=m(d=>d.exams),{currentSemester:a}=m(d=>d.timetable);return h.useEffect(()=>{a&&a.semesterId!==r&&i(y(a.semesterId))},[i,a,r]),h.useEffect(()=>{r&&!l&&!s?i(C(r)):!a&&!s&&!r&&console.warn("MyExamsPage: Current semester info not available to fetch exams.")},[i,r,l,s,a]),e.jsxs(u,{sx:{p:{xs:2,sm:3},minHeight:"70vh"},children:[e.jsxs(c,{variant:"h4",component:"h1",gutterBottom:!0,children:["我的考试安排 ",a?`(${a.semesterName})`:""]}),s&&!l&&e.jsxs(T,{sx:{display:"flex",justifyContent:"center",my:5},children:[e.jsx(E,{})," ",e.jsx(c,{sx:{ml:2},children:"加载考试安排中..."})]}),t&&!s&&e.jsxs(z,{severity:"error",sx:{mt:2},children:["加载考试安排失败: ",t]}),l&&!s&&!t&&e.jsx(L,{exams:x}),l&&!s&&!t&&x.length===0&&a&&e.jsx(c,{sx:{mt:3,textAlign:"center",color:"text.secondary"},children:"本学期暂无考试安排。"}),!a&&!s&&!t&&!r&&e.jsx(c,{sx:{mt:3,textAlign:"center",color:"text.secondary"},children:"请等待学期信息加载..."})]})};export{O as default};
