import{r as h,a6 as M,a5 as N,a7 as W,j as r,a8 as A,a9 as O,ca as V,cb as D,ah as n,aa as U,ad as F,ai as z,af as H,e as S,u as _,c as q,cc as J,P as K,B as R,T as b,d as C,C as Q,b8 as X,R as Y,b7 as Z,bD as tt,bI as ot,f as rt,I as et,bG as at,cd as it,ce as nt,cf as st,cg as lt,ch as dt}from"./index-CKLgkD1v.js";import{E as w}from"./Event-42ReEdWN.js";import{I as ct}from"./Info-IZnw5zVA.js";import{C as ut}from"./Chip-DfvBT8qY.js";import{A as pt}from"./Alert-DDDj34Iz.js";function mt(t){return h.Children.toArray(t).filter(e=>h.isValidElement(e))}function gt(t){return N("MuiButtonGroup",t)}const o=M("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),xt=(t,e)=>{const{ownerState:i}=t;return[{[`& .${o.grouped}`]:e.grouped},{[`& .${o.grouped}`]:e[`grouped${n(i.orientation)}`]},{[`& .${o.grouped}`]:e[`grouped${n(i.variant)}`]},{[`& .${o.grouped}`]:e[`grouped${n(i.variant)}${n(i.orientation)}`]},{[`& .${o.grouped}`]:e[`grouped${n(i.variant)}${n(i.color)}`]},{[`& .${o.firstButton}`]:e.firstButton},{[`& .${o.lastButton}`]:e.lastButton},{[`& .${o.middleButton}`]:e.middleButton},e.root,e[i.variant],i.disableElevation===!0&&e.disableElevation,i.fullWidth&&e.fullWidth,i.orientation==="vertical"&&e.vertical]},ft=t=>{const{classes:e,color:i,disabled:d,disableElevation:s,fullWidth:c,orientation:l,variant:u}=t,p={root:["root",u,l,c&&"fullWidth",s&&"disableElevation",`color${n(i)}`],grouped:["grouped",`grouped${n(l)}`,`grouped${n(u)}`,`grouped${n(u)}${n(l)}`,`grouped${n(u)}${n(i)}`,d&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return U(p,gt,e)},bt=A("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:xt})(F(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${o.lastButton},& .${o.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${o.firstButton},& .${o.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${o.lastButton},& .${o.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${o.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${o.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(z()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderColor:t.vars?`rgba(${t.vars.palette[e].mainChannel} / 0.5)`:H(t.palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${o.lastButton},& .${o.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${o.lastButton},& .${o.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${o.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${o.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(z(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${o.firstButton},& .${o.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${o.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),ht=h.forwardRef(function(e,i){const d=W({props:e,name:"MuiButtonGroup"}),{children:s,className:c,color:l="primary",component:u="div",disabled:p=!1,disableElevation:x=!1,disableFocusRipple:a=!1,disableRipple:m=!1,fullWidth:v=!1,orientation:T="horizontal",size:$="medium",variant:y="outlined",...L}=d,j={...d,color:l,component:u,disabled:p,disableElevation:x,disableFocusRipple:a,disableRipple:m,fullWidth:v,orientation:T,size:$,variant:y},g=ft(j),E=h.useMemo(()=>({className:g.grouped,color:l,disabled:p,disableElevation:x,disableFocusRipple:a,disableRipple:m,fullWidth:v,size:$,variant:y}),[l,p,x,a,m,v,$,y,g.grouped]),I=mt(s),P=I.length,G=B=>{const f=B===0,k=B===P-1;return f&&k?"":f?g.firstButton:k?g.lastButton:g.middleButton};return r.jsx(bt,{as:u,role:"group",className:O(g.root,c),ref:i,ownerState:j,...L,children:r.jsx(V.Provider,{value:E,children:I.map((B,f)=>r.jsx(D.Provider,{value:G(f),children:B},f))})})}),Bt=S(r.jsx("path",{d:"M12 19c0-3.87 3.13-7 7-7 1.08 0 2.09.25 3 .68V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h8.08c-.05-.33-.08-.66-.08-1M4 6l8 5 8-5v2l-8 5-8-5zm13.34 16-3.54-3.54 1.41-1.41 2.12 2.12 4.24-4.24L23 16.34z"})),vt=S(r.jsx("path",{d:"m18 7-1.41-1.41-6.34 6.34 1.41 1.41zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12zM.41 13.41 6 19l1.41-1.41L1.83 12z"})),It=()=>{const t=_(),{notifications:e,isLoading:i,error:d,filter:s,unreadCount:c}=q(a=>a.notifications);h.useEffect(()=>{t(J({filter:s}))},[t,s]);const l=(a,m)=>{m||t(st(a))},u=()=>{c>0&&t(nt())},p=a=>{a!==s&&t(it(a))},x=a=>{switch(a){case"schedule_change":return r.jsx(w,{color:"info"});case"exam":return r.jsx(w,{color:"error"});case"assignment":return r.jsx(dt,{color:"primary"});case"system":return r.jsx(ct,{color:"secondary"});default:return r.jsx(lt,{color:"action"})}};return r.jsxs(K,{sx:{p:{xs:2,sm:3},maxWidth:900,margin:"auto",mt:2},children:[r.jsxs(R,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:1},children:[r.jsx(b,{variant:"h5",component:"h1",gutterBottom:!0,sx:{mb:{xs:1,sm:0}},children:"通知中心"}),r.jsxs(ht,{size:"small","aria-label":"通知筛选",children:[r.jsx(C,{variant:s==="all"?"contained":"outlined",onClick:()=>p("all"),children:"全部消息"}),r.jsx(C,{variant:s==="unread"?"contained":"outlined",onClick:()=>p("unread"),startIcon:c>0?r.jsx(ut,{label:c,size:"small",color:"error",sx:{color:"white",mr:s==="unread"?1:-.5}}):null,children:"未读消息"})]})]}),r.jsxs(C,{size:"small",startIcon:r.jsx(vt,{}),onClick:u,disabled:i||c===0,sx:{mb:2,display:"block",ml:"auto"},color:"primary",children:["全部标记为已读 (",c,")"]}),i&&r.jsx(R,{sx:{display:"flex",justifyContent:"center",my:5},children:r.jsx(Q,{})}),d&&!i&&r.jsxs(pt,{severity:"error",sx:{mt:2},children:["加载通知失败: ",d]}),!i&&!d&&e.length===0&&r.jsx(b,{sx:{mt:4,textAlign:"center",color:"text.secondary"},children:s==="unread"?"太棒了，没有未读通知！":"这里空空如也，还没有任何通知。"}),!i&&!d&&e.length>0&&r.jsx(X,{sx:{bgcolor:"background.paper",borderRadius:1,boxShadow:1},children:e.map((a,m)=>r.jsxs(Y.Fragment,{children:[r.jsxs(Z,{alignItems:"flex-start",secondaryAction:a.isRead?null:r.jsx(rt,{title:"标记为已读",children:r.jsx(et,{edge:"end","aria-label":"mark as read",onClick:()=>l(a.notificationId,a.isRead),children:r.jsx(Bt,{color:"action"})})}),sx:{bgcolor:a.isRead?"action.hover":"transparent",transition:"background-color 0.3s","&:hover":{bgcolor:a.isRead?"action.selected":"primary.lighter"},cursor:a.isRead?"default":"pointer"},onClick:()=>!a.isRead&&l(a.notificationId,a.isRead),children:[r.jsx(tt,{sx:{mt:.5,minWidth:40},children:x(a.type)}),r.jsx(ot,{primary:r.jsx(b,{component:"div",variant:"body1",color:"text.primary",fontWeight:a.isRead?"normal":"bold",children:a.title}),secondary:r.jsxs(R,{component:"div",children:[" ",r.jsx(b,{component:"p",variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.content}),r.jsx(b,{component:"span",variant:"caption",display:"block",color:"text.disabled",sx:{mt:.5},children:new Date(a.notifyTime).toLocaleString("zh-CN",{dateStyle:"short",timeStyle:"short"})})]}),secondaryTypographyProps:{component:"div"}})]}),m<e.length-1&&r.jsx(at,{component:"li"})]},a.notificationId))})]})};export{It as default};
