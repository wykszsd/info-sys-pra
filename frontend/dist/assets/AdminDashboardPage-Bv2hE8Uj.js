import{a5 as D,a6 as T,r as v,a7 as H,j as s,a8 as w,a9 as $,aa as z,P as E,ab as U,ac as O,ad as F,ae as L,af as R,ag as J,ah as q,T as y,ai as G,aj as I,e as W,u as Q,c as b,S as K,A as X,z as Y,ak as Z,al as _,Q as ee,B as M,R as se,am as te,an as oe,ao as ne,ap as re,aq as ae,ar as ie,as as le}from"./index-CKLgkD1v.js";import{G as C}from"./Grid-CW7wBfPk.js";function ce(e){return D("MuiCard",e)}T("MuiCard",["root"]);const de=e=>{const{classes:t}=e;return z({root:["root"]},ce,t)},ue=w(E,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),pe=v.forwardRef(function(t,o){const r=H({props:t,name:"MuiCard"}),{className:i,raised:c=!1,...l}=r,d={...r,raised:c},u=de(d);return s.jsx(ue,{className:$(u.root,i),elevation:c?8:void 0,ref:o,ownerState:d,...l})});function he(e){return D("MuiCardActionArea",e)}const N=T("MuiCardActionArea",["root","focusVisible","focusHighlight"]),me=e=>{const{classes:t}=e;return z({root:["root"],focusHighlight:["focusHighlight"]},he,t)},ge=w(O,{name:"MuiCardActionArea",slot:"Root"})(F(({theme:e})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${N.focusHighlight}`]:{opacity:(e.vars||e).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${N.focusVisible} .${N.focusHighlight}`]:{opacity:(e.vars||e).palette.action.focusOpacity}}))),xe=w("span",{name:"MuiCardActionArea",slot:"FocusHighlight"})(F(({theme:e})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:e.transitions.create("opacity",{duration:e.transitions.duration.short})}))),fe=v.forwardRef(function(t,o){const r=H({props:t,name:"MuiCardActionArea"}),{children:i,className:c,focusVisibleClassName:l,slots:d={},slotProps:u={},...x}=r,m=r,p=me(m),g={slots:d,slotProps:u},[a,n]=U("root",{elementType:ge,externalForwardedProps:{...g,...x},shouldForwardComponentProp:!0,ownerState:m,ref:o,className:$(p.root,c),additionalProps:{focusVisibleClassName:$(l,p.focusVisible)}}),[h,f]=U("focusHighlight",{elementType:xe,externalForwardedProps:g,ownerState:m,ref:o,className:p.focusHighlight});return s.jsxs(a,{...n,children:[i,s.jsx(h,{...f})]})});function Ce(e){return D("MuiLink",e)}const ye=T("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),be=({theme:e,ownerState:t})=>{const o=t.color,r=L(e,`palette.${o}.main`,!1)||L(e,`palette.${o}`,!1)||t.color,i=L(e,`palette.${o}.mainChannel`)||L(e,`palette.${o}Channel`);return"vars"in e&&i?`rgba(${i} / 0.4)`:R(r,.4)},V={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Ae=e=>{const{classes:t,component:o,focusVisible:r,underline:i}=e,c={root:["root",`underline${q(i)}`,o==="button"&&"button",r&&"focusVisible"]};return z(c,Ce,t)},ve=w(y,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[`underline${q(o.underline)}`],o.component==="button"&&t.button]}})(F(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:t,ownerState:o})=>t==="always"&&o.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(e.palette).filter(G()).map(([t])=>({props:{underline:"always",color:t},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.4)`:R(e.palette[t].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:R(e.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.secondaryChannel} / 0.4)`:R(e.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ye.focusVisible}`]:{outline:"auto"}}}]}))),je=v.forwardRef(function(t,o){const r=H({props:t,name:"MuiLink"}),i=J(),{className:c,color:l="primary",component:d="a",onBlur:u,onFocus:x,TypographyClasses:m,underline:p="always",variant:g="inherit",sx:a,...n}=r,[h,f]=v.useState(!1),j=S=>{I(S.target)||f(!1),u&&u(S)},P=S=>{I(S.target)&&f(!0),x&&x(S)},k={...r,color:l,component:d,focusVisible:h,underline:p,variant:g},B=Ae(k);return s.jsx(ve,{color:l,className:$(B.root,c),classes:m,component:d,onBlur:j,onFocus:P,ref:o,ownerState:k,variant:g,...n,sx:[...V[l]===void 0?[{color:l}]:[],...Array.isArray(a)?a:[a]],style:{...n.style,...p==="always"&&l!=="inherit"&&!V[l]&&{"--Link-underlineColor":be({theme:i,ownerState:k})}}})}),ke=W(s.jsx("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"})),A=({title:e,count:t,icon:o,linkTo:r})=>{const i=s.jsxs(pe,{sx:{display:"flex",alignItems:"center",p:2,height:"100%",transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.03)"}},elevation:3,children:[s.jsx(M,{sx:{mr:2.5,color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.lighter",borderRadius:"50%",width:56,height:56},children:se.cloneElement(o,{sx:{fontSize:30}})}),s.jsxs(M,{children:[s.jsx(y,{variant:"h5",component:"div",fontWeight:"bold",children:t}),s.jsx(y,{color:"text.secondary",variant:"subtitle2",children:e})]})]});return r?s.jsx(je,{component:te,to:r,sx:{textDecoration:"none",display:"block",height:"100%"},children:s.jsx(fe,{sx:{height:"100%"},children:i})}):i},Re=()=>{const e=Q();console.log("AdminDashboardPage rendering or re-rendering...");const{totalCount:t,isLoading:o}=b(n=>n.adminCourses),{totalCount:r,isLoading:i}=b(n=>n.adminUsers),{totalCount:c,isLoading:l}=b(n=>n.adminClassrooms),{totalCount:d,isLoading:u}=b(n=>n.adminSemesters),{pendingRequests:x,isLoading:m}=b(n=>n.adminRequests),{totalCount:p,isLoading:g}=b(n=>n.adminSchedules),a=v.useRef({courses:!1,users:!1,classrooms:!1,semesters:!1,requests:!1,schedules:!1});return v.useEffect(()=>{console.log("AdminDashboardPage useEffect CALLED. Component (re)mounted or dispatch changed (unlikely for dispatch)."),console.log("Initial fetchAttemptedRef.current:",JSON.parse(JSON.stringify(a.current))),console.log("Current store states:",{courses:{total:t,loading:o,attempted:a.current.courses},users:{total:r,loading:i,attempted:a.current.users},classrooms:{total:c,loading:l,attempted:a.current.classrooms},semesters:{total:d,loading:u,attempted:a.current.semesters},requests:{length:x.length,loading:m,attempted:a.current.requests},schedules:{total:p,loading:g,attempted:a.current.schedules}});const n=(h,f,j,P,k)=>{!a.current[h]&&f===0&&!j?(console.log(`Attempting to fetch ${h}. Conditions: !attempted (${!a.current[h]}), countOrLength === 0 (${f===0}), !isLoading (${!j})`),e(P(k)),a.current[h]=!0):console.log(`Skipping fetch ${h}. Reason: Attempted: ${a.current[h]}, Count/Length: ${f}, Loading: ${j}`)};return n("courses",t,o,oe,{page:0}),n("users",r,i,ne,{page:0}),n("classrooms",c,l,re,{page:0}),n("semesters",d,u,ae,{page:0}),n("requests",x.length,m,ie),n("schedules",p,g,le,{page:0}),console.log("useEffect finished. Final fetchAttemptedRef.current:",JSON.parse(JSON.stringify(a.current))),()=>{console.log("AdminDashboardPage useEffect cleanup - COMPONENT UNMOUNTING (or dispatch changed, very unlikely)")}},[e]),s.jsxs(E,{sx:{p:{xs:2,sm:3},minHeight:"calc(100vh - 64px - 48px)"},children:[s.jsx(y,{variant:"h4",component:"h1",gutterBottom:!0,sx:{mb:3},children:"管理员控制面板"}),s.jsx(y,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"欢迎回来！您可以在此概览系统关键数据并快速访问管理模块。"}),s.jsxs(C,{container:!0,spacing:3,children:[s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"课程总数",count:o?"...":t,icon:s.jsx(K,{}),linkTo:"/app/admin/courses"})}),s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"注册用户总数",count:i?"...":r,icon:s.jsx(X,{}),linkTo:"/app/admin/users"})}),s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"教室资源总数",count:l?"...":c,icon:s.jsx(Y,{}),linkTo:"/app/admin/classrooms"})}),s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"已录入排课数",count:g?"...":p,icon:s.jsx(Z,{}),linkTo:"/app/admin/schedules"})}),s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"待审批请求",count:m?"...":x.length,icon:s.jsx(_,{}),linkTo:"/app/admin/requests"})}),s.jsx(C,{size:{xs:12,sm:6,md:4},children:s.jsx(A,{title:"学期管理",count:u?"...":d,icon:s.jsx(ee,{}),linkTo:"/app/admin/semesters"})})]}),s.jsxs(M,{sx:{mt:5,borderTop:"1px solid #eee",pt:3},children:[s.jsxs(y,{variant:"h6",component:"div",sx:{display:"flex",alignItems:"center",mb:2},children:[s.jsx(ke,{sx:{mr:1,color:"text.secondary"}})," 系统活动概览 (待开发)"]}),s.jsx(y,{color:"text.secondary",children:"此处可以集成图表展示系统使用频率、资源分配情况等统计信息。"})]})]})};export{Re as default};
